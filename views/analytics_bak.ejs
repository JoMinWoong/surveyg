<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <%- include head.ejs %>
    <link rel='stylesheet' href='/stylesheets/mono.css' />
   
   
   <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Sales', 'Expenses'],
          ['2004',  1000,      400],
          ['2005',  1170,      460],
          ['2006',  660,       1120],
          ['2007',  1030,      540]
        ]);

        var options = {
          title: 'Company Performance',
          vAxis: {title: 'Year',  titleTextStyle: {color: 'red'}}
        };

        var chart = new google.visualization.BarChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
   
   
  </head>
  <body>
  <%- include header.ejs %>
   <div id="chart_div" style="width: 100%; height: 500px;"></div>
  
  	<div><%-JSON.stringify(data.inputdata)%></div>
    <script>inputdata = <%-JSON.stringify(data.inputdata)%> </script>
    <script>useragent = <%-JSON.stringify(data.ua)%> </script>
    <script>area = <%-JSON.stringify(data.area)%> </script>
  
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>



<script>

$(function () {
		for ( var i = 0,xAxis = [],tmp = {a:{ name: "a", data: [], stack: 'stack_a' },b:{ name: "b", data: [], stack: 'stack_b' }},series=[tmp.a,tmp.b]; i < inputdata.length; i++) {
			xAxis.push(inputdata[i]._id);
			for ( var k in inputdata[i].value.data) {
				if(tmp[k]){
					tmp[k].data.push(inputdata[i].value.data[k]);
				}
			}
		}
        $('#container').highcharts({
    
            chart: {
                type: 'column'
            },
    credits: {
      enabled: false
  },
            title: {
                text: 'Survey result'
            },
    
            xAxis: {
                //categories: ['Apples', 'Oranges', 'Pears', 'Grapes', 'Bananas']
                categories: xAxis
            },
    
            yAxis: {
                allowDecimals: false,
                min: 0,
                title: {
                    text: 'answer count'
                }
            },
    
            tooltip: {
                formatter: function() {
                    return '<b>'+ this.x +'</b><br/>'+
                        this.series.name +': '+ this.y +'<br/>'+
                        'Total: '+ this.point.stackTotal;
                }
            },
    
            plotOptions: {
                column: {
                    stacking: 'normal'
                }
            },
    
            series: series
            /*
            [{
                name: 'John',
                data: [5, 3, 4, 7, 2],
                stack: 'male'
            }, {
                name: 'Joe',
                data: [3, 4, 4, 2, 5],
                stack: 'male'
            }, {
                name: 'Jane',
                data: [2, 5, 6, 2, 1],
                stack: 'female'
            }, {
                name: 'Janet',
                data: [3, 0, 4, 4, 3],
                stack: 'female'
            }]
            */
        });
    });


</script>

<br><br><br>
<!-- useragent pie chart -->
<div id="useragentpiechart" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
<script>
$(function () {
    $('#useragentpiechart').highcharts({
        chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false
        },
        title: {
            text: 'useragent pie chart'
        },
        tooltip: {
    	    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
        },
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                    style: {
                        color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                    }
                }
            }
        },
        series: [{
            type: 'pie',
            name: 'Browser share',
            data: 
            (function(){
            	for ( var i = 0,res=[]; i < useragent.length; i++) {
					var line = [];
					line.push(useragent[i]._id);
					line.push(useragent[i].count);
					res.push(line);
				}
				console.log(res);
            	return res;
            })()
        }]
    });
});
</script>

<br><br><br>
<!-- area pie chart -->
<div id="areapiechart" style="min-width: 310px; height: 400px; max-width: 600px; margin: 0 auto"></div>
<script>
$(function () {
    $('#areapiechart').highcharts({
        chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false
        },
        title: {
            text: 'area pie chart'
        },
        tooltip: {
    	    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
        },
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                    style: {
                        color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                    }
                }
            }
        },
        series: [{
            type: 'pie',
            name: 'area share',
            data: 
            (function(){
            	for ( var i = 0,res=[]; i < area.length; i++) {
					var line = [];
					line.push(area[i]._id);
					line.push(area[i].count);
					res.push(line);
				}
				console.log(res);
            	return res;
            })()
        }]
    });
});
</script>




<script src="javascripts/jquery.jqplot.js"></script>
<script src="javascripts/jqlot/plugins/jqplot.barRenderer.js"></script>
<script src="javascripts/jqlot/plugins/jqplot.categoryAxisRenderer.min.js"></script>
<script src="javascripts/jqlot/plugins/jqplot.pointLabels.min.js"></script>


<link rel='stylesheet' href='/stylesheets/jquery.jqplot.css' />

<div><h3>PV : <%=data.pv%>, SU : <%=data.su%></h3></div>

<a href="file:///Users/yesseyall/Downloads/dist%202/examples/bar-charts.html" target="_new">local</a>
<div id="chart2" style="width: 400px; height: 300px; position: relative;" class="jqplot-target"></div>
<script>
$(document).ready(function(){
    // For horizontal bar charts, x an y values must will be "flipped"
    // from their vertical bar counterpart.
    var plot2 = $.jqplot('chart2', [
        //[[2,1], [4,2], [6,3], [3,4]], 
        //[[5,1], [1,2], [3,3], [4,4]], 
        //[[4,1], [7,2], [1,3], [2,4]]
        [[3,1]],[[7,1]]
        
        ], {
        seriesDefaults: {
            renderer:$.jqplot.BarRenderer,
            // Show point labels to the right ('e'ast) of each bar.
            // edgeTolerance of -15 allows labels flow outside the grid
            // up to 15 pixels.  If they flow out more than that, they 
            // will be hidden.
            pointLabels: { show: true, location: 'e', edgeTolerance: -15 },
            // Rotate the bar shadow as if bar is lit from top right.
            shadowAngle: 135,
            // Here's where we tell the chart it is oriented horizontally.
            rendererOptions: {
                barDirection: 'horizontal'
            }
        },
        axes: {
            yaxis: {
                renderer: $.jqplot.CategoryAxisRenderer
            }
        }
    });
});
</script>


  </body>
</html>